<main xmlns="https://tp-runtime.com" xsi:schemaLocation="https://tp-runtime.com ../plugins/tpruntime.xsd" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance">
    <repositories>
        <file-repository name="fs1" folder="/home/ttrocha/_dev/projects/python/thepipeline" />
        <file-repository name="humble" folder="/home/ttrocha/nas-big1/media/2d/humble-stuff" levels="1"/>
    </repositories>

    <pipeline pl-name="animation" target="psx">
        <init>
            <eval>
                vx=320
                vy=0
                clutx=0
                cluty=490 
                scalex=64
                scaley=64
            </eval> 

            <input>
                <file filename="fs1://map2.png" />
                <file filename="fs1://map2_4.png" />
                <file filename="humble://fantasychestspack/1.png" />
            </input>
        </init>
        <ic-psx-tim bpp="16" cpos="VAL,VAL,VAL"/>
        <ic-indexed colors="15" />
        <ic-psx-tim vpos="@[vx]x@[vy]" cpos="@[clutx]x@[cluty]" bpp="4" />
        <eval>
            vx+=64
            cluty+=1
        </eval>  

        <output repository="fs1" filename="export/@[target]/converted-@[init-file-wo-ext].@[file-ext]" />
        <ic-rescale scale="@[scalex]x@[scaley]"/>
        <output repository="fs1" target="all" filename="export/@[target]/converted-@[init-file-wo-ext]-@[scalex]_@[scaley].@[file-ext]" />
        <eval>
            scalex*=2
            scaley*=2
            if scalex>0:
                scaley=512
        </eval> 
    </pipeline>

</main>